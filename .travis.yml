language: scala

scala:
  - 2.10.6

sudo: required
dist: trusty
group: edge

jdk:
  - oraclejdk8
  - oraclejdk9


script:
  # https://github.com/sbt/sbt/pull/2951
  - git clone https://github.com/retronym/java9-rt-export
  - cd java9-rt-export/
  - git checkout 1019a2873d057dd7214f4135e84283695728395d
  - jdk_switcher use oraclejdk8
  - wget https://raw.githubusercontent.com/paulp/sbt-extras/3ba0e52f32d/sbt && chmod +x ./sbt
  - rm project/build.properties
  - ./sbt package
  - jdk_switcher use oraclejdk9
  - mkdir -p $HOME/.sbt/0.13/java9-rt-ext; java -jar target/java9-rt-export-*.jar $HOME/.sbt/0.13/java9-rt-ext/rt.jar
  - jar tf $HOME/.sbt/0.13/java9-rt-ext/rt.jar | grep java/lang/Object
  - cp ./sbt ../
  - cd ..
  - ./sbt -Dscala.ext.dirs=$HOME/.sbt/0.13/java9-rt-ext -jvm-opts travis/jvmopts compile scripted
